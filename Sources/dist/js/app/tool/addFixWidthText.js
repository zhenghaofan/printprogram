define(["jquery","app/Stage","app/Util"],function(e,t,n){var r=function(r){var i=this;i.parent=r,i.name="addfixwidthtext",i.newText=null,i.x=0,i.y=0,i.onmousedown=function(){var r=t.curDoc();r&&(n.Event.dispatch("beforeAddText",this),i.x=t.mouseX(),i.y=t.mouseY(),i.newText=r.addText(),i.newText.isFixedWidth(!0),i.newText.offsetX(i.x),i.newText.offsetY(i.y),e(document).on("mousemove",i.onmousemove),e(document).one("mouseup",i.onmouseup))},i.onmousemove=function(){var e=i.newText,n={UI_LEFT_TOP_X:Math.min(i.x,t.mouseX()),UI_LEFT_TOP_Y:i.y,UI_RIGHT_BOTTOM_X:Math.max(i.x,t.mouseX()),UI_RIGHT_BOTTOM_Y:0};e.UI_INFO(n),i.newText.updateCanvas()},i.onmouseup=function(){e(document).off("mousemove",i.onmousemove),t.updateCanvas(),n.Event.dispatch("afterAddRect",this),i.setDefaultTool()},i.setDefaultTool=function(){i.parent.setDefaultTool()},i.active=function(){e(t.cvs).on("mousedown",i.onmousedown)},i.deactive=function(){e(t.cvs).off("mousedown",i.onmousedown)}};return r});