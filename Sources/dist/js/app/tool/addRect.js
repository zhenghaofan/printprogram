define(["jquery","app/Stage","app/Util"],function(e,t,n){var r=function(r){var i=this;i.parent=r,i.name="addrect",i.newRect=null,i.x=0,i.y=0,i.onmousedown=function(){var r=t.curDoc();r&&(n.Event.dispatch("beforeAddRect",this),i.x=t.mouseX(),i.y=t.mouseY(),i.newRect=r.addRect(),i.newRect.offsetX(i.x),i.newRect.offsetY(i.y),e(document).on("mousemove",i.onmousemove),e(document).one("mouseup",i.onmouseup))},i.onmousemove=function(){var e=i.newRect,n={UI_LEFT_TOP_X:Math.min(i.x,t.mouseX()),UI_LEFT_TOP_Y:Math.min(i.y,t.mouseY()),UI_RIGHT_BOTTOM_X:Math.max(i.x,t.mouseX()),UI_RIGHT_BOTTOM_Y:Math.max(i.y,t.mouseY())};e.UI_INFO(n),i.newRect.updateCanvas()},i.onmouseup=function(){e(document).off("mousemove",i.onmousemove),t.updateCanvas(),n.Event.dispatch("afterAddRect",this),i.setDefaultTool()},i.setDefaultTool=function(){i.parent.setDefaultTool()},i.active=function(){e(t.cvs).on("mousedown",i.onmousedown)},i.deactive=function(){e(t.cvs).off("mousedown",i.onmousedown)}};return r});